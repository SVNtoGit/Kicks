<HBProfile>
   <!-- Profile by Chinajade (last updated for 2011 Hallow's End)
   
      PROFILE EXPECTATIONS:
         * When using this profile, be certain to set the HonorBuddy bot to (select only one):
                ( ) Grinding / Mixed
                (*) Questing
                ( ) PvP
   
         * This profile is appropriate for (check all that apply):
                [X] Alliance   [ ] Achievement
                [ ] Horde      [ ] Farming
                               [ ] Leveling
                               [ ] PvP
                               [X] Questing
                               [ ] Reputation
                               [X] Seasonal
							   
		NOTES:
		 * You will need a fast flying mount to do Vashj'ir.
		   We cross a fatigue area of water, and a slow flying mount probably won't
		   make it across (untested).
			
		 * Druids flight forms get stuck in Vashj'ir, so we use our own mounting code
		    for this area
			
		 * We use variant timers between actions where appropriate to make it look
			more 'human like'.
			
		 * We include coordinates for all the seasonal NPCs as there is a very high chance
			they won't be in the user's Honorbuddy database.
			
		LICENSE:
			This work is licensed under the
				Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.
			also known as CC-BY-NC-SA.  To view a copy of this license, visit
				http://creativecommons.org/licenses/by-nc-sa/3.0/
			or send a letter to
				Creative Commons
				171 Second Street, Suite 300
				San Francisco, California, 94105, USA.		
    -->
   <Name>[A - Fly] Candy Buckets - Vashj'ir [Chinajade] $Revision$</Name>
   <MinLevel>70</MinLevel>	<!-- 70, because we need a 'fast' mount -->
   <MaxLevel>86</MaxLevel>
   
   <MinDurability>0.4</MinDurability>
   <MinFreeBagSlots>2</MinFreeBagSlots>
    
   <MailGrey>False</MailGrey>
   <MailWhite>False</MailWhite>
   <MailGreen>True</MailGreen>
   <MailBlue>True</MailBlue>
   <MailPurple>True</MailPurple>
   
   <SellGrey>True</SellGrey>
   <SellWhite>True</SellWhite>
   <SellGreen>False</SellGreen>
   <SellBlue>False</SellBlue>
   <SellPurple>False</SellPurple>
   
   
   <Blackspots>
       <!-- Ramp in Darnasses otw to Auction House -->
		<Blackspot X="9880.041" Y="2248.925" Z="1329.245" Radius="15" />
   </Blackspots>
   
   <QuestOrder>
		<CustomBehavior File="Message" LogColor="CornflowerBlue"
			Text="Compiling Vashj'ir quests" />
		
		<!-- If we need any of the Vashj'ir points, move there... -->
		<If Condition="!IsAchievementCompleted(5837, 11) || !IsAchievementCompleted(5837, 12) || !IsAchievementCompleted(5837, 13) || !IsAchievementCompleted(5837, 14) || !IsQuestCompleted(28981) || !IsQuestCompleted(28982) || !IsQuestCompleted(28983) || !IsQuestCompleted(28985)" >
		
			<!-- You *must* have "Sea Legs" buff...
				Our inital attempt at this profile also allowed for a Potion/Elixir
				of Water Breathing.   However, we discovered that without the "Sea Legs"
				Honorbuddy cannot navigate (or FlyTo) in Vashj'ir.   This is because the
				zone is not in the correct 'phase' until you have the "Sea Legs" buff.
				So, although there may be remnants of Potion support in this profile,
				potion use has been disallowed by the early tests.
			  -->
			<CustomBehavior File="UserDialog" AllowBotStop="true" ExpiryTime="120"
				Text="You must have two things to do the Vashj'ir pumpkins:\n\n* The &quot;Sea Legs&quot; buff\nYou must 'open up' Vashj'ir by doing the first quest that provides you with the &quot;Sea Legs&quot; buff.  Otherwise, several of the Vashj'ir destinations will be too deep, and you'll drown trying to reach them.  The Vashj'ir zone is available at level 80, and starts by pickup up &quot;Call fo Duty&quot; [http://www.wowhead.com/quest=14482] from Recruiter Burns [http://www.wowhead.com/npc=36799] at the Stormwind docks).\nAlso, Honorbuddy is incapable of navigating Vashj'ir until you have the &quot;Sea Legs&quot; buff--as Vashj'ir is in the wrong 'phase' until the buff is acquired.\n\n* The 'fast flying' skill.\nWe will be crossing water that will cause fatigue.   The 'slow flying' skill is not fast enough to safely reach the other side.  (A fast flying skill will produce about 40% fatigue before recovery starts.)\n\nPractically speaking, this means you need to be at least level 70 to meet these requirements.  We provide NO checks for these requirements.  You will simply get into a 'death loop' if you do not meet them." />

			<CustomBehavior File="UserSettings" Preset="NoDistractions"
				LearnFlightPaths="false" UseFlightPaths="false" />

			<!-- Use Handful of Treats, if in our bags...
				 If it still exists in our bags after we use it, destroy it.
				 This means we took all the non-unique stuff out of the item, and
				 all that remains is unique stuff that we already possess (in our bags
				 or in the bank).
			  -->
			<CustomBehavior File="Misc\RunLua" Lua="UseItemByName(37586)" />
			<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />
			<CustomBehavior File="Misc\RunLua" Lua="CloseLoot()" />
			<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />

			<CustomBehavior File="Misc\RunLua" Lua="local id,n=0; for b=0,4 do for s=1,GetContainerNumSlots(b) do id=GetContainerItemID(b,s) if (id == 37586) then ClearCursor() PickupContainerItem(b,s) DeleteCursorItem() end end end" />
			<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />
				
			<!-- Move to Vashj'ir -->
			<If Condition="(Me.MapId == 0) &amp;&amp; !((Me.ZoneId == 5146) || (Me.ZoneId == 5145) || (Me.ZoneId == 4815) || (Me.ZoneId == 5144))" >
				<CustomBehavior File="Message" LogColor="CornflowerBlue"
					Text="Moving to Vashj'ir" />
				<CustomBehavior File="FlyTo" DestName="Kalimdor west coast"
					X="-5325.916" Y="1354.602" Z="603.7166" />
				<CustomBehavior File="MyCTM" DestName="Vashj'ir Sandy Beach"
					X="-5360.642" Y="3880.676" Z="68.77172" />
				<CustomBehavior File="ForcedDismount" />
			</If>
			
			<If Condition="!((Me.ZoneId == 5146) || (Me.ZoneId == 5145) || (Me.ZoneId == 4815) || (Me.ZoneId == 5144))" >
				<CustomBehavior File="UserDialog" StopOnContinue="true"
					Text="Whoops, you're not where we left you.\n\nPlease move to Eastern Kingdoms or Vashj'ir, and start the profile again." />
			</If>

			<If Condition="!Me.HasAura(&quot;Sea Legs&quot;)" >
				<CustomBehavior File="Message" LogColor="Red"
					Text="&quot;Sea Legs&quot; buff is missing!  SKIPPING Vashj'ir sub-achievements." />
				<CustomBehavior File="UserDialog"
					Text="Unable to continue.\n\nYou do not have the &quot;Sea Legs&quot; aura.  When the profile is continued, we will return you to Stormwind." />

			<Else>
				<!-- Vashj'ir, Deepmist Grotto -->
				<If Condition="!IsAchievementCompleted(5837, 12) || !IsQuestCompleted(28981)" >
					<CustomBehavior File="Message" LogColor="CornflowerBlue"
						Text="Moving to Deepmist Grotto pumpkin" />
					
					<!-- Cancel any costume we may have, as some prevent us from mounting -->
					<CustomBehavior File="Misc\RunLua" Lua="for i=1,40 do name,_ = UnitAura(&quot;player&quot;, i) if (name == nil) then break end if (strfind(name, &quot;Costume&quot;)) then CancelUnitBuff(&quot;player&quot;, i) end end" />
					<CustomBehavior File="WaitTimer" WaitTime="700" VariantTime="1500" />						
					<If Condition="(Me.HasAura(&quot;Trick&quot;))" >
						<CustomBehavior File="WaitTimer" WaitTime="55000" VariantTime="15000"
						GoalText="Waiting for Trick to expire {TimeRemaining}" />
					</If>

					<!-- Due to HBcore bug, Druids get struck trying to shift to flight
						 form while swimming.  We work around that, by explicitly using a
						 'normal' mount, instead of flight form. -->
					<While Condition="!Me.IsFlying">
						<If Condition="!Me.Mounted" >
							<CustomBehavior File="Misc\RunLua" Lua="for i=1,GetNumCompanions(&quot;MOUNT&quot;) do _,_,_,_,_,flags=GetCompanionInfo(&quot;MOUNT&quot;,i); if (bit.band(flags,0x02) > 0) then CallCompanion(&quot;MOUNT&quot;, i) break end end" />
							<CustomBehavior File="WaitTimer" WaitTime="2500" VariantTime="1500" />
						</If>

						<CustomBehavior File="Misc\RunLua" Lua="JumpOrAscendStart()" />
						<CustomBehavior File="WaitTimer" WaitTime="1000" VariantTime="3000" />
					</While>
					<CustomBehavior File="Misc\RunLua" Lua="AscendStop()" />
					
					<CustomBehavior File="FlyTo" DestName="Deepmist Grotto"
						X="-5264.76" Y="3388.688" Z="11.20931" />
					<CustomBehavior File="ForcedDismount" />
					<If Condition="Me.Class == WoWClass.Druid" >
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(1066)" />
					<ElseIf Condition="(Me.Class == WoWClass.Shaman) &amp;&amp; SpellManager.CanCast(131)" >
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(131)" />
						</ElseIf>
					<ElseIf Condition="Me.Class == WoWClass.Warlock &amp;&amp; SpellManager.CanCast(5697)" >
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(5697)" />
						</ElseIf>
					</If>
					<CustomBehavior File="MyCTM" X="-5236.015" Y="3379.014" Z="-136.0156" />
					<CustomBehavior File="MyCTM" X="-5144.837" Y="3293.227" Z="-119.5735" />
					
					<!-- Snag new Handful of Treats -->
					<CustomBehavior File="InteractWith" MobId="208141" ObjectType="Gameobject"
						X="-5144.837" Y="3293.227" Z="-119.5735" WaitTime="100" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2000" />
					<CustomBehavior File="Misc\RunLua" Lua="GetQuestReward(1)" />

					<!-- Use Handful of Treats, if in our bags...
						 If it still exists in our bags after we use it, destroy it.
						 This means we took all the non-unique stuff out of the item, and
						 all that remains is unique stuff that we already possess (in our bags
						 or in the bank).
					  -->
					<CustomBehavior File="Misc\RunLua" Lua="UseItemByName(37586)" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />
					<CustomBehavior File="Misc\RunLua" Lua="CloseLoot()" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />

					<CustomBehavior File="Misc\RunLua" Lua="local id,n=0; for b=0,4 do for s=1,GetContainerNumSlots(b) do id=GetContainerItemID(b,s) if (id == 37586) then ClearCursor() PickupContainerItem(b,s) DeleteCursorItem() end end end" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />				
					<!-- move outside -->
					<CustomBehavior File="MyCTM" X="-5144.837" Y="3293.227" Z="-119.5735" />
					<CustomBehavior File="MyCTM" X="-5236.015" Y="3379.014" Z="-136.0156" />
				</If>
				
				<!-- Vashj'ir, Silver Tide Hollow -->
				<If Condition="!IsAchievementCompleted(5837, 13) || !IsQuestCompleted(28982)" >
					<CustomBehavior File="Message" LogColor="CornflowerBlue"
						Text="Moving to Silver Tide Hollow pumpkin" />
					
					<!-- Cancel any costume we may have, as some prevent us from mounting -->
					<CustomBehavior File="Misc\RunLua" Lua="for i=1,40 do name,_ = UnitAura(&quot;player&quot;, i) if (name == nil) then break end if (strfind(name, &quot;Costume&quot;)) then CancelUnitBuff(&quot;player&quot;, i) end end" />
					<CustomBehavior File="WaitTimer" WaitTime="700" VariantTime="1500" />						
					<If Condition="(Me.HasAura(&quot;Trick&quot;))" >
						<CustomBehavior File="WaitTimer" WaitTime="55000" VariantTime="15000"
						GoalText="Waiting for Trick to expire {TimeRemaining}" />
					</If>

					<!-- Due to HBcore bug, Druids get struck trying to shift to flight
						 form while swimming.  We work around that, by explicitly using a
						 'normal' mount, instead of flight form. -->
					<While Condition="!Me.IsFlying">
						<If Condition="!Me.Mounted" >
							<CustomBehavior File="Misc\RunLua" Lua="for i=1,GetNumCompanions(&quot;MOUNT&quot;) do _,_,_,_,_,flags=GetCompanionInfo(&quot;MOUNT&quot;,i); if (bit.band(flags,0x02) > 0) then CallCompanion(&quot;MOUNT&quot;, i) break end end" />
							<CustomBehavior File="WaitTimer" WaitTime="2500" VariantTime="1500" />
						</If>

						<CustomBehavior File="Misc\RunLua" Lua="JumpOrAscendStart()" />
						<CustomBehavior File="WaitTimer" WaitTime="1000" VariantTime="3000" />
					</While>
					<CustomBehavior File="Misc\RunLua" Lua="AscendStop()" />
					
					<CustomBehavior File="FlyTo" DestName="Silver Tide Hollow"
						X="-5958.664" Y="4230.054" Z="4.423082" />
					<CustomBehavior File="ForcedDismount" />
					<If Condition="Me.Class == WoWClass.Druid">
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(1066)" />
					<ElseIf Condition="(Me.Class == WoWClass.Shaman) &amp;&amp; SpellManager.CanCast(131)" >
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(131)" />
						</ElseIf>
					<ElseIf Condition="Me.Class == WoWClass.Warlock &amp;&amp; SpellManager.CanCast(5697)" >
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(5697)" />
						</ElseIf>
					</If>
					<CustomBehavior File="MyCTM" X="-5958.664" Y="4230.054" Z="-375.8177" />
					<CustomBehavior File="MyCTM" X="-6114.71" Y="4278.24" Z="-350.7117" />
					
					<!-- Snag new Handful of Treats -->
					<CustomBehavior File="InteractWith" MobId="208142" ObjectType="Gameobject"
						X="-6111.506" Y="4294.206" Z="-348.6067" WaitTime="100" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2000" />
					<CustomBehavior File="Misc\RunLua" Lua="GetQuestReward(1)" />

					<!-- Use Handful of Treats, if in our bags...
						 If it still exists in our bags after we use it, destroy it.
						 This means we took all the non-unique stuff out of the item, and
						 all that remains is unique stuff that we already possess (in our bags
						 or in the bank).
					  -->
					<CustomBehavior File="Misc\RunLua" Lua="UseItemByName(37586)" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />
					<CustomBehavior File="Misc\RunLua" Lua="CloseLoot()" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />

					<CustomBehavior File="Misc\RunLua" Lua="local id,n=0; for b=0,4 do for s=1,GetContainerNumSlots(b) do id=GetContainerItemID(b,s) if (id == 37586) then ClearCursor() PickupContainerItem(b,s) DeleteCursorItem() end end end" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />

					<!-- move outside -->
					<CustomBehavior File="MyCTM" X="-6114.71" Y="4278.24" Z="-350.7117" />
					<CustomBehavior File="MyCTM" X="-5958.664" Y="4230.054" Z="-375.8177" />
				</If>
				
				<!-- Vashj'ir, Tranquil Wash -->
				<If Condition="!IsAchievementCompleted(5837, 14) || !IsQuestCompleted(28983)" >
					<CustomBehavior File="Message" LogColor="CornflowerBlue"
						Text="Moving to Tranquil Wash pumpkin" />
					
					<!-- Cancel any costume we may have, as some prevent us from mounting -->
					<CustomBehavior File="Misc\RunLua" Lua="for i=1,40 do name,_ = UnitAura(&quot;player&quot;, i) if (name == nil) then break end if (strfind(name, &quot;Costume&quot;)) then CancelUnitBuff(&quot;player&quot;, i) end end" />
					<CustomBehavior File="WaitTimer" WaitTime="700" VariantTime="1500" />
					
					<If Condition="(Me.HasAura(&quot;Trick&quot;))" >
						<CustomBehavior File="WaitTimer" WaitTime="55000" VariantTime="15000"
						GoalText="Waiting for Trick to expire {TimeRemaining}" />
					</If>

					<!-- Due to HBcore bug, Druids get struck trying to shift to flight
						 form while swimming.  We work around that, by explicitly using a
						 'normal' mount, instead of flight form. -->
					<While Condition="!Me.IsFlying">
						<If Condition="!Me.Mounted" >
							<CustomBehavior File="Misc\RunLua" Lua="for i=1,GetNumCompanions(&quot;MOUNT&quot;) do _,_,_,_,_,flags=GetCompanionInfo(&quot;MOUNT&quot;,i); if (bit.band(flags,0x02) > 0) then CallCompanion(&quot;MOUNT&quot;, i) break end end" />
							<CustomBehavior File="WaitTimer" WaitTime="2500" VariantTime="1500" />
						</If>

						<CustomBehavior File="Misc\RunLua" Lua="JumpOrAscendStart()" />
						<CustomBehavior File="WaitTimer" WaitTime="1000" VariantTime="3000" />
					</While>
					<CustomBehavior File="Misc\RunLua" Lua="AscendStop()" />

					<CustomBehavior File="FlyTo" DestName="Tranquil Wash"
						X="-6603.419" Y="4621.897" Z="0.1214749" />
					<CustomBehavior File="ForcedDismount" />
					<If Condition="Me.Class == WoWClass.Druid">
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(1066)" />
					<ElseIf Condition="(Me.Class == WoWClass.Shaman) &amp;&amp; SpellManager.CanCast(131)">
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(131)" />
						</ElseIf>
					<ElseIf Condition="Me.Class == WoWClass.Warlock &amp;&amp; SpellManager.CanCast(5697)">
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(5697)" />
						</ElseIf>
					</If>
					<CustomBehavior File="MyCTM" X="-6603.419" Y="4621.897" Z="-532.0801"  />
					<CustomBehavior File="MyCTM" X="-6614.11" Y="4372.972" Z="-582.7677" />
					<CustomBehavior File="MyCTM" X="-6601.526" Y="4307.074" Z="-564.2615" />
					
					<!-- Snag new Handful of Treats -->
					<CustomBehavior File="InteractWith" MobId="208133" ObjectType="Gameobject"
						X="-6610.523" Y="4272.179" Z="-562.7366" WaitTime="100" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2000" />
					<CustomBehavior File="Misc\RunLua" Lua="GetQuestReward(1)" />
					
					<!-- Use Handful of Treats, if in our bags...
						 If it still exists in our bags after we use it, destroy it.
						 This means we took all the non-unique stuff out of the item, and
						 all that remains is unique stuff that we already possess (in our bags
						 or in the bank).
					  -->
					<CustomBehavior File="Misc\RunLua" Lua="UseItemByName(37586)" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />
					<CustomBehavior File="Misc\RunLua" Lua="CloseLoot()" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />

					<CustomBehavior File="Misc\RunLua" Lua="local id,n=0; for b=0,4 do for s=1,GetContainerNumSlots(b) do id=GetContainerItemID(b,s) if (id == 37586) then ClearCursor() PickupContainerItem(b,s) DeleteCursorItem() end end end" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />

					<!-- move outside -->
					<CustomBehavior File="MyCTM" X="-6601.526" Y="4307.074" Z="-564.2615" />
					<CustomBehavior File="MyCTM" X="-6614.11" Y="4372.972" Z="-582.7677" />
					<CustomBehavior File="MyCTM" X="-6603.419" Y="4621.897" Z="-532.0801"  />
				</If>
				
				<!-- Vashj'ir, Darkbreak Cove -->
				<If Condition="!IsAchievementCompleted(5837, 11) || !IsQuestCompleted(28985)" >
					<CustomBehavior File="Message" LogColor="CornflowerBlue"
						Text="Moving to Darkbreak Cove pumpkin" />
					
					<!-- Cancel any costume we may have, as some prevent us from mounting -->
					<CustomBehavior File="Misc\RunLua" Lua="for i=1,40 do name,_ = UnitAura(&quot;player&quot;, i) if (name == nil) then break end if (strfind(name, &quot;Costume&quot;)) then CancelUnitBuff(&quot;player&quot;, i) end end" />
					<CustomBehavior File="WaitTimer" WaitTime="700" VariantTime="1500" />
					
					<If Condition="(Me.HasAura(&quot;Trick&quot;))" >
						<CustomBehavior File="WaitTimer" WaitTime="55000" VariantTime="15000"
						GoalText="Waiting for Trick to expire {TimeRemaining}" />
					</If>

					<!-- Due to HBcore bug, Druids get struck trying to shift to flight
						 form while swimming.  We work around that, by explicitly using a
						 'normal' mount, instead of flight form. -->
					<While Condition="!Me.IsFlying">
						<If Condition="!Me.Mounted" >
							<CustomBehavior File="Misc\RunLua" Lua="for i=1,GetNumCompanions(&quot;MOUNT&quot;) do _,_,_,_,_,flags=GetCompanionInfo(&quot;MOUNT&quot;,i); if (bit.band(flags,0x02) > 0) then CallCompanion(&quot;MOUNT&quot;, i) break end end" />
							<CustomBehavior File="WaitTimer" WaitTime="2500" VariantTime="1500" />
						</If>

						<CustomBehavior File="Misc\RunLua" Lua="JumpOrAscendStart()" />
						<CustomBehavior File="WaitTimer" WaitTime="1000" VariantTime="3000" />
					</While>
					<CustomBehavior File="Misc\RunLua" Lua="AscendStop()" />
					
					<CustomBehavior File="FlyTo" DestName="Darkbreak Cove"
						X="-7142.945" Y="5669.394" Z="5.414822" />
					<CustomBehavior File="ForcedDismount" />
					<If Condition="Me.Class == WoWClass.Druid">
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(1066)" />
					<ElseIf Condition="(Me.Class == WoWClass.Shaman) &amp;&amp; SpellManager.CanCast(131)">
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(131)" />
						</ElseIf>
					<ElseIf Condition="Me.Class == WoWClass.Warlock &amp;&amp; SpellManager.CanCast(5697)">
						<CustomBehavior File="Misc\RunLua" Lua="CastSpellByID(5697)" />
						</ElseIf>
					</If>
					<CustomBehavior File="MyCTM" X="-7142.945" Y="5669.394" Z="-785.0261" />
					<CustomBehavior File="MyCTM" X="-7015.99" Y="5873.923" Z="-793.2481" />
					<CustomBehavior File="MyCTM" X="-6902.952" Y="5956.76" Z="-766.6032" />
					
					<!-- Snag new Handful of Treats -->
					<CustomBehavior File="InteractWith" MobId="208132" ObjectType="Gameobject"
						X="-6867.623" Y="6005.045" Z="-764.0035" WaitTime="100" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2000" />
					<CustomBehavior File="Misc\RunLua" Lua="GetQuestReward(1)" />
					
					<!-- Use Handful of Treats, if in our bags...
						 If it still exists in our bags after we use it, destroy it.
						 This means we took all the non-unique stuff out of the item, and
						 all that remains is unique stuff that we already possess (in our bags
						 or in the bank).
					  -->
					<CustomBehavior File="Misc\RunLua" Lua="UseItemByName(37586)" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />
					<CustomBehavior File="Misc\RunLua" Lua="CloseLoot()" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />

					<CustomBehavior File="Misc\RunLua" Lua="local id,n=0; for b=0,4 do for s=1,GetContainerNumSlots(b) do id=GetContainerItemID(b,s) if (id == 37586) then ClearCursor() PickupContainerItem(b,s) DeleteCursorItem() end end end" />
					<CustomBehavior File="WaitTimer" WaitTime="500" VariantTime="2500" />

					<!-- move outside -->
					<CustomBehavior File="MyCTM" X="-6902.952" Y="5956.76" Z="-766.6032" />
					<CustomBehavior File="MyCTM" X="-7015.99" Y="5873.923" Z="-793.2481" />
					<CustomBehavior File="MyCTM" X="-7142.945" Y="5669.394" Z="-785.0261" />
				</If>		
				</Else>
			</If>
		</If>
		
		<!-- If we're in Vashj'ir, move back to EK... -->
		<If Condition="(Me.ZoneId == 5146) || (Me.ZoneId == 5145) || (Me.ZoneId == 4815) || (Me.ZoneId == 5144)" >
			<CustomBehavior File="Message" LogColor="CornflowerBlue"
				Text="Moving to Eastern Kindgoms" />
				
			<!-- Cancel any costume we may have, as some prevent us from mounting -->
			<CustomBehavior File="Misc\RunLua" Lua="for i=1,40 do name,_ = UnitAura(&quot;player&quot;, i) if (name == nil) then break end if (strfind(name, &quot;Costume&quot;)) then CancelUnitBuff(&quot;player&quot;, i) end end" />
			<CustomBehavior File="WaitTimer" WaitTime="700" VariantTime="1500" />					
			<!-- Due to HBcore bug, Druids get struck trying to shift to flight
				 form while swimming.  We work around that, by explicitly using a
				 'normal' mount, instead of flight form. -->
			<While Condition="!Me.IsFlying">
					<If Condition="!Me.Mounted" >
						<CustomBehavior File="Misc\RunLua" Lua="for i=1,GetNumCompanions(&quot;MOUNT&quot;) do _,_,_,_,_,flags=GetCompanionInfo(&quot;MOUNT&quot;,i); if (bit.band(flags,0x02) > 0) then CallCompanion(&quot;MOUNT&quot;, i) break end end" />
						<CustomBehavior File="WaitTimer" WaitTime="2500" VariantTime="1500" />
					</If>

					<CustomBehavior File="Misc\RunLua" Lua="JumpOrAscendStart()" />
					<CustomBehavior File="WaitTimer" WaitTime="1000" VariantTime="3000" />
				</While>
			<CustomBehavior File="Misc\RunLua" Lua="AscendStop()" />
			
			<CustomBehavior File="FlyTo" DestName="Vashj'ir Sandy Beach"
				X="-5360.642" Y="3880.676" Z="68.77172" />
			<CustomBehavior File="MyCTM" DestName="Kalimdor west coast"
				X="-5325.916" Y="1354.602" Z="603.7166" />
		</If>
		
		<If Condition="Me.MapId != 0" >
			<CustomBehavior File="UserDialog" StopOnContinue="true"
				Text="Whoops, you're not where we left you.\n\nPlease move to Eastern Kingdoms and start the profile again." />
		</If>
		
		<!-- Deploy to a random place inside Stormwind -->
		<If Condition="Chance(20.0)">
			<CustomBehavior File="FlyTo" DestName="Elder's mailbox" X="-8859.798" Y="640.8622" Z="96.28608" />
		<ElseIf Condition="Chance(20.0)">
			<CustomBehavior File="FlyTo" DestName="Backgate Bank" X="-8360.063" Y="620.2231" Z="95.35557" />
			</ElseIf>
		<ElseIf Condition="Chance(20.0)">
			<CustomBehavior File="FlyTo" DestName="Cathedral Square mailbox" X="-8657.595" Y="775.6388" Z="96.99747" />
			</ElseIf>
		<ElseIf Condition="Chance(20.0)">
			<CustomBehavior File="FlyTo" DestName="Fishing pier mailbox"  X="-8826.954" Y="729.8922" Z="98.42244" />
			</ElseIf>
		<Else Condition="Chance(20.0)">
			<CustomBehavior File="FlyTo" DestName="Canal mailbox" X="-8752.236" Y="561.497" Z="97.43406" />
			</Else>
		</If>
		
		<CustomBehavior File="ForcedDismount" />

			<!--
		  ========== All we can automate ==========
		  -->
		<CustomBehavior File="UserDialog" StopOnContinue="true"
				Text="END of the line." />
		
	</QuestOrder>
   
      
	<!-- Helpful LUA Snippets...
		/run print(GetAchievementCriteriaInfo(1184,1))
		/run print(GetQuestLogLeaderBoard(1,GetQuestLogIndexByID(11118)))
	  -->
   
</HBProfile>